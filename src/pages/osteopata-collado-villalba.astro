---
import Layout from '../layouts/Layout.astro';
import CTASection from '../components/CTASection.astro';
import { getLocalityBySlug } from '../data/localities';
import { services } from '../data/services';

const locality = getLocalityBySlug('osteopata-collado-villalba')!;

const businessSchema = {
  "@context": "https://schema.org",
  "@type": "HealthAndBeautyBusiness",
  "name": "Katy Caballero - Osteópata y Masajista",
  "image": "https://katycaballeroosteopata.com/images/logo.png",
  "telephone": "+34643961065",
  "url": "https://katycaballeroosteopata.com",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Calle Río Guadarrama 2",
    "addressLocality": "Alpedrete",
    "addressRegion": "Madrid",
    "postalCode": "28430",
    "addressCountry": "ES"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "40.6631",
    "longitude": "-4.0270"
  },
  "areaServed": { "@type": "City", "name": locality.name },
  "priceRange": "€€"
};

const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": locality.faq.map(f => ({
    "@type": "Question",
    "name": f.question,
    "acceptedAnswer": { "@type": "Answer", "text": f.answer }
  }))
};

const breadcrumbSchema = [
  { name: "Inicio", url: "/" },
  { name: `Osteópata ${locality.name}` }
];
---

<Layout title={locality.metaTitle} description={locality.metaDescription} keywords={locality.keywords} breadcrumbs={breadcrumbSchema}>
  <script type="application/ld+json" set:html={JSON.stringify(businessSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />

  <section class="locality-header">
    <div class="container">
      <span class="section-tag">Osteópata cerca de {locality.name}</span>
      <h1>Osteópata y Masajista cerca de {locality.name}</h1>
      <p class="locality-distance">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
        Consulta en Alpedrete · {locality.distance} · {locality.driveTime} en coche
      </p>
      <a href="https://wa.me/34643961065?text=Hola%20Katy,%20soy%20de%20Collado%20Villalba%20y%20me%20gustaría%20reservar%20una%20cita" class="btn btn-primary" target="_blank" rel="noopener">Reservar cita</a>
    </div>
  </section>

  <section class="locality-intro">
    <div class="container">
      <div class="intro-content">
        {locality.intro.split('\n\n').map(p => <p>{p}</p>)}
      </div>
    </div>
  </section>

  <section class="locality-services">
    <div class="container">
      <h2>Servicios disponibles</h2>
      <div class="services-grid">
        {services.map(s => (
          <a href={`/servicios/${s.slug}`} class="service-link-card">
            <h3>{s.title}</h3>
            <div class="service-link-meta">
              <span>{s.duration}</span>
              <span class="service-link-price">{s.price}</span>
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>

  <section class="locality-why">
    <div class="container">
      <h2>¿Por qué elegirnos desde {locality.name}?</h2>
      <ul class="why-list">
        {locality.whyUs.map(item => (
          <li>
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            {item}
          </li>
        ))}
      </ul>
    </div>
  </section>

  <section class="locality-faq">
    <div class="container">
      <h2>Preguntas frecuentes</h2>
      <div class="faq-grid">
        {locality.faq.map(f => (
          <details class="faq-item">
            <summary>{f.question}</summary>
            <p>{f.answer}</p>
          </details>
        ))}
      </div>
    </div>
  </section>

  <CTASection
    title={`¿Vienes desde ${locality.name}?`}
    description="Reserva tu cita y en pocos minutos estarás en consulta."
  />
</Layout>

<style>
  .locality-header { padding-top: 150px; padding-bottom: 60px; background: linear-gradient(135deg, var(--color-cream) 0%, var(--color-warm-white) 100%); text-align: center; }
  .locality-header h1 { margin-bottom: 15px; }
  .locality-distance { display: inline-flex; align-items: center; gap: 8px; font-size: 1.1rem; color: var(--color-text-light); margin-bottom: 30px; }
  .locality-distance svg { width: 22px; height: 22px; fill: var(--color-primary); }
  .locality-intro { background: var(--color-warm-white); }
  .intro-content { max-width: 800px; margin: 0 auto; }
  .intro-content p { margin-bottom: 20px; line-height: 1.8; font-size: 1.05rem; }
  .locality-services { background: var(--color-cream); }
  .locality-services h2 { text-align: center; margin-bottom: 40px; }
  .services-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
  .service-link-card { background: var(--color-warm-white); padding: 25px; border-radius: 16px; text-decoration: none; color: inherit; transition: all 0.3s ease; border: 1px solid rgba(90, 124, 89, 0.1); }
  .service-link-card:hover { transform: translateY(-4px); box-shadow: 0 8px 25px rgba(90, 124, 89, 0.12); border-color: var(--color-primary-light); }
  .service-link-card h3 { font-size: 1.05rem; color: var(--color-primary); margin-bottom: 12px; }
  .service-link-meta { display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; color: var(--color-text-light); }
  .service-link-price { background: var(--color-secondary-light); padding: 4px 14px; border-radius: 20px; font-weight: 600; color: var(--color-text); }
  .locality-why { background: var(--color-warm-white); }
  .locality-why h2 { text-align: center; margin-bottom: 40px; }
  .why-list { max-width: 700px; margin: 0 auto; list-style: none; display: flex; flex-direction: column; gap: 15px; }
  .why-list li { display: flex; align-items: center; gap: 12px; font-size: 1.02rem; line-height: 1.5; }
  .why-list svg { width: 22px; height: 22px; fill: var(--color-primary); flex-shrink: 0; }
  .locality-faq { background: var(--color-cream); }
  .locality-faq h2 { text-align: center; margin-bottom: 40px; }
  .faq-grid { max-width: 800px; margin: 0 auto; display: flex; flex-direction: column; gap: 15px; }
  .faq-item { background: var(--color-warm-white); border-radius: 15px; overflow: hidden; border: 1px solid rgba(90, 124, 89, 0.1); transition: all 0.3s ease; }
  .faq-item[open] { box-shadow: 0 4px 15px rgba(90, 124, 89, 0.1); }
  .faq-item summary { padding: 20px 25px; cursor: pointer; font-weight: 600; color: var(--color-text); font-size: 1.05rem; list-style: none; display: flex; justify-content: space-between; align-items: center; gap: 15px; }
  .faq-item summary::-webkit-details-marker { display: none; }
  .faq-item summary::after { content: '+'; font-size: 1.4rem; color: var(--color-primary); font-weight: 300; flex-shrink: 0; }
  .faq-item[open] summary::after { content: '−'; }
  .faq-item summary:hover { color: var(--color-primary); }
  .faq-item p { padding: 0 25px 20px; color: var(--color-text-light); line-height: 1.8; font-size: 0.95rem; max-width: none; }
  @media (max-width: 1024px) { .services-grid { grid-template-columns: repeat(2, 1fr); } }
  @media (max-width: 600px) { .services-grid { grid-template-columns: 1fr; } }
</style>
